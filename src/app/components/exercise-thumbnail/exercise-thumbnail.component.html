<div [ngSwitch]="DisplayMode">

    <div *ngSwitchCase="displayMode.Workout">
        <div [hidden]="IsRunning">
            <ion-list lines="none">
                <ion-item *ngFor="let exercise of exercises; let i = index; let first = first">
                    <ion-row class="ion-align-items-start">
                        <ion-col size="3">
                            <ion-button id="img-btn">
                                <img [src]="safeImage(images[i])" (click)="goToImagesLibraryPage(exercise)"/>
                            </ion-button>
                        </ion-col>
                        <ion-col size="8">
                            <ion-label color="dark">
                                <h2 class="ion-text-wrap">{{exercise.name}}</h2>
                                <app-exercise-variation class="ion-text-wrap" #variationComponent
                                    [exercise]="exercise">
                                </app-exercise-variation>
                            </ion-label>
                        </ion-col>
                        <ion-col size="1">
                            <ion-button *ngIf="first" class="ion-float-right" fill="clear"
                                (click)="runExercise()"
                                color="danger">
                                <ion-icon slot="icon-only" name="play"></ion-icon>
                            </ion-button>
                        </ion-col>
                    </ion-row>
                </ion-item>
            </ion-list>
        </div>
        <div [hidden]="!IsRunning">
            <ion-grid>
                <ion-row class="ion-justify-content-around">
                    <ion-col *ngFor="let exercise of exercises; let i = index">
                        <ion-label class="ion-text-wrap ion-text-center" color="dark">
                            {{exercise.name}}
                        </ion-label>
                    </ion-col>
                </ion-row>
                <ion-row class="ion-justify-content-around">
                    <ion-col *ngFor="let exercise of exercises; let i = index" class="ion-text-center">
                        <ion-button id="img-btn">
                            <img [src]="safeImage(images[i])" (click)="goToImagesLibraryPage(exercise)"/>
                        </ion-button>
                    </ion-col>
                </ion-row>
                <ion-row class="ion-justify-content-around">
                    <ion-col *ngFor="let exercise of exercises">
                        <app-exercise-variation [exercise]="exercise"
                            class="ion-text-wrap ion-text-center">
                        </app-exercise-variation>
                    </ion-col>
                </ion-row>
                <ion-row *ngFor="let exercise of exercises;"
                    id=repsRow class="ion-align-items-center">
                    <ion-col *ngFor="let rep of exercise.reps; let i = index"
                        id="colRep" ion-no-padding>
                        <div *ngIf='rep.weight'
                            [ngClass]="getRepClass(rep, i)"
                            [ngStyle]="getRepTimesStyle(rep, i)">
                            <h4 class="ion-text-center"
                                [ngClass]="{'comlpeted': rep.isComplete}">
                                {{rep.weight}}
                                <small>{{' ' + weightUnit[rep.weightUnit]}}</small>
                            </h4>
                        </div>
                        <div *ngIf='rep.times'
                            [ngClass]="getRepClass(rep, i)"
                            [ngStyle]="getRepTimesStyle(rep, i)">
                            <h4 class="ion-text-center"
                                [ngClass]="{'comlpeted': rep.isComplete}">
                                {{rep.times}}
                                <small>Reps</small>
                            </h4>
                        </div>
                        <div *ngIf="rep.seconds" class="nonActiveRep seconds">
                            <h4 class="ion-text-center seconds"
                                [ngClass]="{'comlpeted': rep.isComplete}">
                                {{getSecondsStateText(rep)}}
                            </h4>
                            <ion-progress-bar *ngIf="rep.isActive"
                                color="secondary" reversed="true"
                                [value]="getSecondsProgress(rep)">
                            </ion-progress-bar>
                        </div>
                    </ion-col>
                </ion-row>
                <ion-row class="ion-justify-content-center">
                    <ion-col *ngIf="isResting" class="ion-text-center">
                        <ion-button expand="block" class="et-button" (click)="skipRest()">
                            Rest {{timedRestRemaining}} Seconds or Skip
                        </ion-button>
                    </ion-col>
                    <ion-buttons *ngIf="!isResting">
                        <ion-col class="ion-text-end">
                            <ion-button fill="clear" color="danger" [disabled]="!isPrevRepAvailable"
                                (click)="prevRep()">
                                <ion-icon slot="icon-only" name="skip-backward"></ion-icon>
                            </ion-button>
                        </ion-col>
                        <ion-col size="6">
                            <ion-button expand="block" class="et-button"
                                (click)="nextRep(true)" >
                                Done!
                            </ion-button>
                        </ion-col>
                        <ion-col class="ion-text-start">
                            <ion-button fill="clear" color="danger" (click)="nextRep(false)">
                                <ion-icon slot="icon-only" name="skip-forward"></ion-icon>
                            </ion-button>
                        </ion-col>
                    </ion-buttons>
                </ion-row>
            </ion-grid>
        </div>
    </div>

    <div *ngSwitchCase="displayMode.Edit">
        <ion-grid>
            <ion-row class="ion-justify-content-around">
                <ion-col *ngFor="let exercise of exercises; let i = index"
                    class="ion-no-padding ion-padding-end">
                    <ion-textarea type="text" rows="1" autoGrow="true"
                        required="true" maxlength="64"
                        [ngModel]="exercise.name"
                        (change)="exerciseChanged(i, $event.target.value, 'name')"
                        class="editInputSec ion-text-center"
                        placeholder="Enter exercise name here...">
                    </ion-textarea>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col *ngFor="let exercise of exercises; let i = index; let last = last"
                    class="ion-no-padding ion-text-center">
                    <ion-button id="img-btn" (click)="selectExerciseAction($event, exercise, i, last)">
                        <img [src]="safeImage(images[i])" />
                    </ion-button>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col *ngFor="let exercise of exercises; let i = index"
                    class="ion-text-center">
                    <ion-button (click)="presentVariationPopover($event, exercise)">
                        <app-exercise-variation class="ion-text-wrap ion-text-center"
                            [exercise]="exercise"
                            [inEditMode]="true">
                        </app-exercise-variation>
                    </ion-button>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col>
                    <ion-button expand="full" fill="clear" color="danger"
                        (click)="toggleExpandedExercise()">
                        <ion-icon slot="icon-only"
                            [name]="expanded ? 'arrow-up' : 'arrow-down'"></ion-icon>
                    </ion-button>
                </ion-col>
            </ion-row>
            <ion-row *ngFor="let exercise of ExpandedExercises;"
                class="ion-align-items-center ion-no-margin editSets">
                <ion-col *ngFor="let rep of exercise.reps; let i = index"
                    class="ion-text-center editSets ion-no-padding">
                    <ion-button expand="full" fill="clear"
                        class="ion-no-margin ion-no-padding"
                        (click)="selectSetAction($event, exercise, i, rep)">
                        <div class="editSets">
                            <h4 *ngIf='rep.weight' class="ion-text-center">
                                {{rep.weight}}
                                <small>{{' ' + weightUnit[rep.weightUnit]}}</small>
                            </h4>
                            <h4 *ngIf='rep.times' class="ion-text-center">
                                {{rep.times}}
                                <small>Reps</small>
                            </h4>
                            <h4 *ngIf='rep.seconds' class="ion-text-center">
                                {{rep.seconds}}
                                <small>Sec</small>
                            </h4>
                            <h4 *ngIf='!rep.weight && !rep.times && !rep.seconds'
                                class="ion-text-center">
                                ...
                            </h4>
                        </div>
                    </ion-button>
                </ion-col>
            </ion-row>
            <ion-row class="ion-justify-content-center" *ngIf="expanded">
                <ion-col>
                    <ion-list lines="none">
                        <ion-item>
                            <h3 class="ion-text-center" slot="start">
                                Rest between sets: {{restBetweenReps}} sec
                            </h3>
                        </ion-item>
                        <ion-item>
                            <ion-range [(ngModel)]="restBetweenReps" debounce="100" pin="true"
                                (ionChange)="exerciseChanged(0, $event.target.value, 'restBetweenReps')">
                                <ion-icon slot="start" size="small" name="stopwatch" color="dark"></ion-icon>
                                <ion-icon slot="end" name="stopwatch" color="dark"></ion-icon>
                            </ion-range>
                        </ion-item>
                        <ion-item>
                            <h3 class="ion-text-center" slot="start">
                                Rest after sets: {{restAfterExercise}} sec
                            </h3>
                        </ion-item>
                        <ion-item>
                            <ion-range [(ngModel)]="restAfterExercise" debounce="100" pin="true"
                                (ionChange)="exerciseChanged(0, $event.target.value, 'restAfterExercise')">
                                <ion-icon slot="start" size="small" name="stopwatch" color="dark"></ion-icon>
                                <ion-icon slot="end" name="stopwatch" color="dark"></ion-icon>
                            </ion-range>
                        </ion-item>
                    </ion-list>
                </ion-col>
            </ion-row>
        </ion-grid>
    </div>

    <div *ngSwitchDefault>
        <ion-list lines="none">
            <ion-item *ngFor="let exercise of exercises; let i = index">
                <ion-row class="ion-align-items-start">
                    <ion-col size="3">
                        <ion-button id="img-btn">
                            <img [src]="safeImage(images[i])" (click)="goToImagesLibraryPage(exercise)"/>
                        </ion-button>
                    </ion-col>
                    <ion-col size="9">
                        <ion-label class="ion-align-items-start" color="dark">
                            <h2 class="ion-text-wrap">{{exercise.name}}</h2>
                            <app-exercise-variation class="ion-text-wrap" [exercise]="exercise">
                            </app-exercise-variation>
                        </ion-label>
                    </ion-col>
                </ion-row>
            </ion-item>
        </ion-list>
    </div>

</div>